---
layout: post
title: DESeq2 for differential expression analysis
date: '2017-10-24T05:36:00.000-07:00'
author: Aarthi Ramakrishnan
tags: 
modified_time: '2018-05-31T12:08:38.040-07:00'
blogger_id: tag:blogger.com,1999:blog-2313420884919503029.post-1806557864182754758
blogger_orig_url: http://aarthiramakrishnan.blogspot.com/2017/10/deseq2-for-differential-expression.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">Tools like <a href="https://bioconductor.org/packages/release/bioc/html/DESeq2.html" target="_blank">DESeq2</a> and <a href="http://bioconductor.org/packages/release/bioc/html/edgeR.html" target="_blank">edgeR</a> help demonstrate the enormous power of statistics in Bioinformatics. DESeq2 is a powerful Bioconductor package which helps us perform differential expression analysis using RNA-seq data.<br /><br />Let us consider a hypothetical example:<br /><table>    <tbody><tr>        <td><b>sample</b></td>        <td><b>sex</b></td>        <td><b>treatment</b></td>    </tr><tr>        <td>1</td>        <td>m</td>        <td>morphine</td>    </tr><tr>        <td>2</td>        <td>f</td>        <td>morphine</td>    </tr><tr>        <td>3</td>        <td>m</td>        <td>saline</td>    </tr><tr>        <td>4</td>        <td>f</td>        <td>saline</td>    </tr></tbody></table><br />The model for such an experiment would be log(exp) ~ sex&nbsp;+ treatment. Here, sex and treatment represent features (also known as covariates or factors), and there are 2 levels for each feature in this example. But this model assumes that the effect of treatment is the same for both males and females (also known as additive effect in statistics). For each feature, we add an effect regardless of what the other feature is. This model is suitable just for pairwise comparisons (male vs. female, morphine vs. saline).<br /><br />To account for the interaction between sex and treatment, an 'interaction term' can be added to the model. The updated model can helps us find sex specific treatment effect OR treatment specific sex effect (<b>female specific</b> and <b>male specific</b> morphine treatment effect for instance). To do this, following is the design of the linear model:<br /><br />log(exp) ~ sex&nbsp;+ treatment&nbsp;+ sex:treatment<br /><br />This is assuming that the model matrix is full rank, i.e., we have samples for all levels of all factors. The above equation can also be written as follows:<br /><br />log(exp) ~ sex * treatment<br /><br />The major issues I faced with DESeq2 while 'extracting results' were:<br /><br />1) What if I want to change the control group? I would have to run the model again (in the case of 2 different control groups in the same factor).<br /><br />2) What if I want to compare male morphine vs. female saline? Male morphine vs. female morphine can be done, male saline vs. female saline can be done, morphine vs. saline in males can be done and morphine vs. saline in females can be done. But male morphine vs. female saline and male saline vs. female morphine cannot be extracted.&nbsp;</div>