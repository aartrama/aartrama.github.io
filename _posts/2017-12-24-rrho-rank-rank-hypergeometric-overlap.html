---
layout: post
title: RRHO (Rank Rank Hypergeometric Overlap)
date: '2017-12-24T01:45:00.001-08:00'
author: Aarthi Ramakrishnan
tags: 
modified_time: '2018-06-03T07:58:14.012-07:00'
thumbnail: https://3.bp.blogspot.com/-j1Nb27flnxU/WxMH5ThAWqI/AAAAAAAABDE/teIe9UySA943fY3lIGC1wKy0G0J5BOXKgCK4BGAYYCw/s72-c/12964_2015_96_Fig6_HTML.gif
blogger_id: tag:blogger.com,1999:blog-2313420884919503029.post-3387559039020056185
blogger_orig_url: http://aarthiramakrishnan.blogspot.com/2017/12/rrho-rank-rank-hypergeometric-overlap.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><span style="font-family: inherit;">RRHO is used to find the overlap between two gene lists. To generate an RRHO, every gene in each gene list should have a log fold change and a p-value associated to it. This test does not consider a fold change or a p-value cutoff. Rather, it uses ALL the genes in the gene lists.</span><br /><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span><b>Steps to generate RRHO -</b></span><br /><span style="font-family: inherit;"><b><br /></b>1) The first step is to identify the common genes between the 2 gene lists. If the first gene list has 300 genes, and second gene list has 290 genes, 289 genes remain in gene list 1 and 289 genes remain in gene list 2 (assuming 289 genes are common b/w the two lists).</span><br /><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">2) Next, genes in each gene list are ranked based on the signed negative log of p-value. 'Signed' here refers to assigning a '+' or a '-' sign to the - log (p-value), depending on whether the gene is up or down-regulated.&nbsp;</span>The genes at the top of the list would have the most significantly up-regulated genes, and the genes at the bottom would have the most significantly down-regulated genes.</span><br /><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span><u>Gene list 1&nbsp;</u></span><br /><span style="font-family: inherit;">gene8&nbsp; &nbsp; &nbsp; rank1&nbsp; &nbsp; &nbsp;&lt;- most significantly up-regulated</span><br /><span style="font-family: inherit;">gene53&nbsp; &nbsp; rank2</span><br /><span style="font-family: inherit;">gene6&nbsp; &nbsp; &nbsp; rank3</span><br /><span style="font-family: inherit;">gene1&nbsp; &nbsp; &nbsp; rank4</span><br /><span style="font-family: inherit;">gene5&nbsp; &nbsp; &nbsp; rank5&nbsp; &nbsp; &lt;- most significantly down-regulated</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; .&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; .&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; .&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.</span><br /><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span><u>Gene list 2</u></span><br /><span style="font-family: inherit;">gene5&nbsp; &nbsp; &nbsp; rank1</span><br /><span style="font-family: inherit;">gene10&nbsp; &nbsp; rank2</span><br /><span style="font-family: inherit;">gene31&nbsp; &nbsp; rank3</span><br /><span style="font-family: inherit;">gene94&nbsp; &nbsp; rank4</span><br /><span style="font-family: inherit;">gene8&nbsp; &nbsp; &nbsp; rank5</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; .&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; .&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; .&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;"><span style="font-family: inherit;"><span style="font-family: &quot;georgia&quot; , &quot;times new roman&quot; , serif;">3)&nbsp;</span></span><span style="font-family: inherit;">The ranks are then used to generate a scatter plot and to compute spearman correlation between the 2 gene lists. This is done to know whether there is a positive or a negative correlation between the 2 gene lists.</span></span><br /><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span></span><span style="font-family: inherit;"><span style="font-family: inherit;">4) A step size is calculated. Step size depends upon the length of each gene list. We can consider the square root of 289, which is 17, as the step size.</span></span><br /><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span></span><span style="font-family: inherit;"><span style="font-family: inherit;">5) Considering the top 17 genes in gene list 1 and top 17 genes in gene list 2, a hypergeometric test is carried out to find the significance of overlap. Next, top 17 genes from gene list 1 and top 34 genes in gene list 2 are considered, and hypergeometric test is used to find the significance. This step is carried out until we are through all 289 genes, and obtain 289 p-value measurements.</span></span><br /><span style="font-family: inherit;"><span style="font-family: inherit;"><span style="font-family: &quot;georgia&quot; , &quot;times new roman&quot; , serif;"><br /></span></span><u>Gene list 1</u>&nbsp; &nbsp; <u>Gene list 2</u>&nbsp; &nbsp; &nbsp; p-value</span><br /><span style="font-family: inherit;">17 genes&nbsp; &nbsp; &nbsp; &nbsp; 17 genes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ..</span><br /><span style="font-family: inherit;">17 genes&nbsp; &nbsp; &nbsp; &nbsp; 34 genes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ..</span><br /><span style="font-family: inherit;">17 genes&nbsp; &nbsp; &nbsp; &nbsp; 51 genes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ..</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; ...&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;...&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;..</span><br /><span style="font-family: inherit;">34 genes&nbsp; &nbsp; &nbsp; &nbsp; 17 genes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ..</span><br /><span style="font-family: inherit;">34 genes&nbsp; &nbsp; &nbsp; &nbsp; 34 genes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ..</span><br /><span style="font-family: inherit;">34 genes&nbsp; &nbsp; &nbsp; &nbsp; 51 genes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ..</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; ...&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;...&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;..</span><br /><span style="font-family: inherit;"><span style="font-family: inherit;">289 genes&nbsp; &nbsp; &nbsp; 289 genes&nbsp; &nbsp; &nbsp; &nbsp; ..</span></span><br /><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span></span><span style="font-family: inherit;"><span style="font-family: inherit;">We use this list of p-values to fill the RRHO matrix, starting from the bottom left corner. We should also apply a bonferroni correction to the p-values in the RRHO matrix.&nbsp;</span></span><br /><span style="font-family: inherit;"><span style="font-family: &quot;georgia&quot; , &quot;times new roman&quot; , serif;"><br /></span><span style="font-family: &quot;georgia&quot; , &quot;times new roman&quot; , serif;">6) In the end, we obtain a 17x17 matrix for -log(p-values). This matrix is typically represented as a heat map; the color scale ranging from red (for most significant) to blue (least significant).&nbsp;</span></span><br /><span style="font-family: inherit;"><span style="font-family: &quot;georgia&quot; , &quot;times new roman&quot; , serif;"><br /></span></span></div><div style="text-align: center;"><a href="http://3.bp.blogspot.com/-j1Nb27flnxU/WxMH5ThAWqI/AAAAAAAABDE/teIe9UySA943fY3lIGC1wKy0G0J5BOXKgCK4BGAYYCw/s1600/12964_2015_96_Fig6_HTML.gif" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><span style="font-family: inherit;"><img border="0" height="185" src="https://3.bp.blogspot.com/-j1Nb27flnxU/WxMH5ThAWqI/AAAAAAAABDE/teIe9UySA943fY3lIGC1wKy0G0J5BOXKgCK4BGAYYCw/s200/12964_2015_96_Fig6_HTML.gif" width="200" /></span></a><span style="font-family: inherit;">&nbsp;</span></div><span style="font-family: inherit;"><span style="color: #999999; font-size: x-small;"></span><br /></span><br /><div style="text-align: center;"><span style="color: #999999; font-family: inherit; font-size: x-small;"><br /></span></div><span style="color: #999999; font-family: inherit; font-size: x-small;"></span><br /><div><div style="text-align: center;"><span style="color: #999999; font-family: inherit; font-size: x-small;">https://openi.nlm.nih.gov/detailedresult.phpimg=PMC4396151_12964_2015_96_Fig6_HTML&amp;req=4</span></div><div style="text-align: center;"><span style="font-family: inherit;"><br /></span></div><div style="text-align: center;"><span style="font-family: inherit;">This RRHO has a red signal in the bottom left quadrant, which represents the presence of significantly co up-regulated genes. Red denotes high significance, and blue denotes poor significance of overlap.</span></div><div><div style="text-align: center;"><span style="font-family: inherit;"><br /></span></div><div style="text-align: center;"><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span></span><br /><div dir="ltr" style="text-align: left;" trbidi="on"><span style="font-family: inherit;">The 4 quadrants of the RRHO map represent the following -</span><br /><span style="font-family: inherit;"><br /></span></div><div style="text-align: center;"><table style="border-collapse: collapse; border-spacing: 0px; border: 1px solid black; color: black; text-align: center;"><tbody><tr><td class="c0 r0" colspan="1" rowspan="1" style="border: 1px solid black; padding: 8px;"><div style="outline: none;"><div style="margin: 0px;"><span style="font-family: inherit;">&nbsp;Up in list1,&nbsp;</span></div><div style="outline: none;"><div style="margin: 0px;"><span style="font-family: inherit;">down in list2</span></div><div style="margin: 0px;"><span style="font-family: inherit;"><br /></span></div></div></div></td><td class="c1 r0" colspan="1" rowspan="1" style="border: 1px solid black; padding: 8px;"><div style="outline: none;"><div style="margin: 0px;"><span style="font-family: inherit;">Co</span></div><div style="outline: none;"><div style="margin: 0px;"><span style="font-family: inherit;">down-</span></div><div style="margin: 0px;"><span style="font-family: inherit;">regulated</span></div><div style="margin: 0px;"><span style="font-family: inherit;"><br /></span></div></div></div></td></tr><tr><td class="c0 r1" colspan="1" rowspan="1" style="border: 1px solid black; padding: 8px;"><div style="outline: none;"><div style="margin: 0px;"><span style="font-family: inherit;">Co</span></div><div style="outline: none;"><div style="margin: 0px;"><span style="font-family: inherit;">up-</span></div><div style="margin: 0px;"><span style="font-family: inherit;">regulated</span></div><div style="margin: 0px;"><span style="font-family: inherit;"><br /></span></div></div></div></td><td class="c1 r1" colspan="1" rowspan="1" style="border: 1px solid black; padding: 8px;"><div style="outline: none;"><div style="margin: 0px;"><span style="font-family: inherit;">Up in list2,&nbsp;</span></div><div style="outline: none;"><div style="margin: 0px;"><span style="font-family: inherit;">Down in list1</span><br /><div><br /></div></div></div></div></td></tr></tbody></table><div style="text-align: left;"><br /></div><div style="text-align: left;">Reference:&nbsp;<a href="https://academic.oup.com/nar/article/38/17/e169/1033168" style="text-align: left;">https://academic.oup.com/nar/article/38/17/e169/1033168</a></div></div><div style="text-align: center;"></div></div><div style="text-align: center;"><div style="text-align: left;"><span style="font-family: inherit;"><br /></span></div></div><div style="text-align: center;"><div style="text-align: left;"><span style="font-family: inherit;">Caveat: The RRHO cannot represent negative correlations, i.e., if the spearman correlation is negative, the RRHO map would appear blue.</span></div></div><div style="text-align: center;"><span style="font-family: inherit;"><br /></span></div><div style="text-align: center;"><br /></div></div></div></div>