---
layout: post
title: Visualization of ChIP-seq data
date: '2017-05-07T16:42:00.004-07:00'
author: Aarthi Ramakrishnan
tags: 
modified_time: '2018-05-14T13:25:20.107-07:00'
blogger_id: tag:blogger.com,1999:blog-2313420884919503029.post-4504322865018335903
blogger_orig_url: http://aarthiramakrishnan.blogspot.com/2017/05/visualization-of-chip-seq-data.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><span style="font-family: inherit;">For visualization of ChIP-seq datasets, it is always recommended to convert bedgraph files obtained from MACS to bigwig format files prior to visualization on the UCSC genome browser. Following are the steps to be followed for the conversion:&nbsp;</span><br /><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">1. To sort bedgraph output files from MACS, use the following command</span></span><br /><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span><!-- HTML generated using hilite.me --></span><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="font-family: inherit;"><span style="color: #996633;">LC_COLLATE</span><span style="color: #333333;">=</span>C sort -k1,1 -k2,2n filename.bdg &gt; sorted.filename.bdg<br /></span></pre></div><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span> <span style="font-family: inherit;">2. (OPTIONAL) Once all files (control and treated) have been sorted, the next step is to remove the last line from each of the sorted files. This can be done using the following code:</span></span><br /><span style="font-family: inherit;"><br /></span><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="font-family: inherit;">head -n -1 sorted.filename.bdg &gt; temp.sorted.filename.bdg ; mv temp.sorted.filename.bdg sorted.filename.bdg<br /></span></pre></div><span style="font-family: inherit;"><br /></span> <span style="color: #cccccc; font-family: inherit;">*credits - http://stackoverflow.com/questions/4881930/remove-the-last-line-from-a-file-in-bash</span><br /><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span></span><br /><span style="font-family: inherit;">3. (OPTIONAL) Next, the sorted files should be clipped using the tool bedClip. Following is the command to be used:</span><br /><span style="font-family: inherit;"><br /></span><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;">bedClip sorted.filename.bdg hg38.chrom.sizes sorted.clipped.filename.bdg<br /></pre></div><br /><span style="font-family: inherit;"><span style="font-family: inherit;">Where hg38.chrom.sizes is a tab delimited text file that contains chromosome name (without 'chr' in the beginning of each line) in the first column and chromosome size in the second column. This information can be obtained from SAM files of the same datasets generated using a reference from ENSEMBL .&nbsp;</span></span><br /><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span></span><br /><span style="font-family: inherit;">4. (OPTIONAL) The next step would be to add 'chr' to each line in all bedgraph files, as UCSC file format requires 'chr' to be present before each chromosome name (for chromosomes 1-22, X and Y). I do this using a custom python script as follows:</span><br /><span style="font-family: inherit;"><br /></span><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #dd4422;">"""</span><br /><span style="color: #dd4422;">This program is for adding</span><br /><span style="color: #dd4422;">chr to each line of the bdg</span><br /><span style="color: #dd4422;">file if line starts with</span><br /><span style="color: #dd4422;">1-22, x or y</span><br /><span style="color: #dd4422;">"""</span><br /><br /><br /><span style="color: #888888;"># INSERTION OF FILE NAMES</span><br /><br />files <span style="color: #333333;">=</span> [<span style="background-color: #fff0f0;">'sorted.clipped.filename.bdg'</span>, \<br /> <span style="background-color: #fff0f0;">'sorted.clipped.filename1.bdg'</span>, \<br /> <span style="background-color: #fff0f0;">'sorted.clipped.filename2.bdg'</span>, \<br /> <span style="background-color: #fff0f0;">'sorted.clipped.filename3.bdg'</span>]<br /><br /><span style="color: #888888;"># CREATION OF LIST OF CHROMOSOMES</span><br /><br />list1 <span style="color: #333333;">=</span> [<span style="background-color: #fff0f0;">'X'</span>, <span style="background-color: #fff0f0;">'Y', 'MT'</span>]<br /><br /><span style="color: #008800; font-weight: bold;">for</span> i <span style="color: black; font-weight: bold;">in</span> <span style="color: #007020;">range</span>(<span style="color: #0000dd; font-weight: bold;">1</span>, <span style="color: #0000dd; font-weight: bold;">23</span>):<br />    list1<span style="color: #333333;">.</span>append(<span style="color: #007020;">str</span>(i))<br /><br /><span style="color: #008800; font-weight: bold;">for</span> <span style="color: #007020;">file</span> <span style="color: black; font-weight: bold;">in</span> files:<br />    <span style="color: #008800; font-weight: bold;">with</span> <span style="color: #007020;">open</span>(<span style="color: #007020;">file</span>, <span style="background-color: #fff0f0;">"r"</span>) <span style="color: #008800; font-weight: bold;">as</span> f, \<br />    <span style="color: #007020;">open</span>(<span style="background-color: #fff0f0;">"chr."</span><span style="color: #333333;">+</span><span style="color: #007020;">file</span>, <span style="background-color: #fff0f0;">"w"</span>) <span style="color: #008800; font-weight: bold;">as</span> outfile:<br />    <span style="color: #008800; font-weight: bold;">for</span> lines <span style="color: black; font-weight: bold;">in</span> f:<br />        lines <span style="color: #333333;">=</span> lines<span style="color: #333333;">.</span>strip()<span style="color: #333333;">.</span>split()<br />        <span style="color: #008800; font-weight: bold;">if</span> lines[<span style="color: #0000dd; font-weight: bold;">0</span>] <span style="color: black; font-weight: bold;">in</span> list1:<br />            <span style="color: #008800; font-weight: bold;">print</span><span style="color: #333333;">&gt;&gt;</span>outfile, <span style="background-color: #fff0f0;">"chr"</span><span style="color: #333333;">+</span><span style="background-color: #fff0f0;">"</span><span style="background-color: #fff0f0; color: #666666; font-weight: bold;">\t</span><span style="background-color: #fff0f0;">"</span><span style="color: #333333;">.</span>join(lines)<br /></pre></div><br /><span style="font-family: inherit;"><span style="font-family: inherit;">5. The final step is the conversion of bedgraph file to bigwig file. To do this, bedGraphToBigWig tool from UCSC can be utilized. Following is the command (note that hg38.chrom.sizes should have 'chr' at the beginning of each chromosome here):</span></span><br /><span style="font-family: inherit;"><span style="font-family: inherit;"><br /></span></span><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;">bedGraphToBigWig sorted.clipped.filename.bdg hg38.chrom.sizes filename.bw<br /></pre></div><br /><span style="font-family: inherit;">You can now upload the bw files in a web server and provide the link to these files in 'custom tracks' of UCSC Genome Browser.</span></div>